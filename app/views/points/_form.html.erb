<div class="form-login" id="to-hide">
  <div class="row row-form">
    <div class="step active" style="">
      <div class="point-form-text">
        <p>When submitting a contribution, you submit what we call a "point." It's an analysis on one specific aspect of the ToS of the service that you want to rate. All points have a rating from 1 to 10 and the class given to the service is the average of all those ratings. See the <a href="/about#classification">about page</a> for more information.</p>

        <p>Each point submitted by a user has to be reviewed by a curator before being displayed on the website. You will recieve a message by email from the curator who reviewed your point.</p>
      </div>

      <%= simple_form_for [@point] do |f| %>

      <div class="form-field-width margin-bottom-text" id="get-service-id">
        <%= f.association :service, collection: Service.order('name ASC'), hint: "Pick the service that you want to review" %>
        <span onclick="openStep('step-2', event)", class="btn btn-default margin-bottom-larger"> Next </span>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6">
      <%= f.association :topic, collection: Topic.order('title ASC'), hint: "Category of the point" %>
    </div>
    <div class="col-xs-12">
      <%= f.input :title, hint: "Give your point a short descriptive title (max 140 chars)" %>
    </div>
    <div class="col-xs-12">
      <%= f.input :analysis, as: :text , input_html: { rows: 7, class: "text-area" }, hint: "Write your analysis and comments" %>
    </div>
    <div class="col-xs-12 col-sm-5">
      <%= f.input :source, hint: "Where did you find it?" %>
    </div>
    <div class="col-xs-6 col-sm-3">
      <%= f.input :rating, as: :radio_buttons, collection: [['blocker', 0], ['bad', 2], ['neutral', 5], ['good', 8]], hint: "Choose your rating" %>
    </div>
    <div class="col-xs-6 col-sm-4">
      <% if current_user.curator? %>
      <%= f.input :status, collection: ["pending", "draft", "approved", "declined", "disputed"] %>
      <% else %>
      <%= f.input :status, collection: ["pending", "draft"], hint: "Choose pending for the curators to review your point" %>
      <% end %>
    </div>
    <% if params[:action] == "edit" %>
    <div class="col-xs-12">
      <%= f.input :point_change, as: :text, input_html: { rows: 4, class: "text-area" }, hint: "Provide a reason for your changes to this analysis point." %>
    </div>
    <% end %>
    <div class="form-actions col-xs-4 col-sm-2 col-md-2">
      <%= link_to "Back", :back, class: "btn btn-default" %>
    </div>
    <div class="form-actions col-xs-8 col-sm-4 col-sm-offset-6 col-md-3 col-md-offset-7">
      <% if params[:action] == "new" %>
        <%= f.submit "Submit", name: "only_create", class: 'btn btn-primary' %>
        <%= f.submit "Submit + Add Another", name: "create_add_another", class: 'btn btn-primary' %>
      <% else %>
        <%= f.submit "Update", class: 'btn btn-primary' %>
      <% end %>
    </div>
  </div>
</div>

  <%= render 'steps' %>

<script>
  // for steps
  document.getElementById('further-steps').style.display = "none"

  function openStep(tabName, event) {
    document.querySelectorAll(".step").forEach(
      function(tab){
        tab.classList.add('active');
      });
    event.currentTarget.classList.remove("active");
    var i;
    var x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
     x[i].style.display = "none";
   }
   document.getElementById(tabName).style.display = "block";
 }

 // for setting the service in the standard submission form if no case is given
  document.getElementById('trigger-id-grab').addEventListener('click', function() {
    document.getElementById('to-hide').style.display = "none";
    document.getElementById('further-steps').style.display = "block";
    var selected_index = document.getElementById('get-service-id').childNodes[1].childNodes[1].options.selectedIndex;
    document.getElementById('set-service').childNodes[1].childNodes[1].options.selectedIndex = selected_index;
  });
</script>
